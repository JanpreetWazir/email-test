# Email Security Test Vectors - Explained

This document explains the various email address formats generated by this tool and why they're important for security testing.

## Categories of Test Vectors

### 1. Basic RFC-Compliant Formats
These test standard email parsing and validation:

- `user@domain.com` - Standard format
- `u.ser@domain.com` - Dots in local part
- `user+tag@domain.com` - Plus addressing (email aliasing)
- `user_name@domain.com` - Underscores in local part
- `user-name@domain.com` - Hyphens in local part

**Security Relevance**: Tests basic email validation bypasses and ensures proper handling of common formats.

### 2. Quoted Local Parts
These test proper parsing of quoted strings in email addresses:

- `"user"@domain.com` - Simple quoted local part
- `"user.name"@domain.com` - Quoted with dots
- `"user name"@domain.com` - Spaces in quoted local part
- `"user\\@name"@domain.com` - Escaped @ symbol
- `" "@domain.com` - Single space as local part

**Security Relevance**: Tests for quote-escaping vulnerabilities and proper handling of special characters within quotes.

### 3. Comments (RFC 5322)
Email addresses can contain comments in parentheses:

- `user(comment)@domain.com` - Comment in local part
- `(foo)user@(bar)domain.com` - Multiple comments
- `user@(comment)domain.com` - Comment in domain part

**Security Relevance**: Many email validators strip comments incorrectly, potentially allowing bypasses.

### 4. Case Sensitivity Tests
Tests how applications handle email case variations:

- `USER@DOMAIN.COM` - All uppercase
- `User@Domain.Com` - Mixed case
- `user@DOMAIN.COM` - Domain uppercase

**Security Relevance**: Tests for case-sensitivity bypasses in email validation and duplicate account creation.

### 5. IP Address Literals
Tests support for IP addresses in email domains:

- `user@[127.0.0.1]` - IPv4 literal
- `user@[IPv6:2001:db8::1]` - IPv6 literal
- `user@localhost` - Local domain

**Security Relevance**: Tests for SSRF vulnerabilities when systems attempt to validate or connect to these addresses.

### 6. Internationalized Domain Names (IDN)
Tests Unicode and Punycode domain handling:

- `user@exämple.domain.com` - Unicode characters
- `user@例子.domain.com` - Chinese characters
- `user@пример.domain.com` - Cyrillic characters
- `user@xn--e1afmkfd.domain.com` - Punycode encoding

**Security Relevance**: Tests for homograph attacks, encoding bypasses, and IDN spoofing vulnerabilities.

### 7. RFC 2047 Encoded Words
Tests encoded word parsing (used in email headers):

- `=?UTF-8?B?dXNlcg==?=@domain.com` - Base64 encoded
- `=?UTF-8?Q?user?=@domain.com` - Quoted-printable encoded

**Security Relevance**: Tests for header injection and encoding bypasses.

### 8. Legacy Email Routing
Tests old email routing formats still valid in RFC:

- `user%collaborator@target.com` - Percent routing
- `target.com!user@collaborator` - UUCP bang path routing

**Security Relevance**: Tests for email routing attacks and bypasses in modern systems that might still process these formats.

### 9. Valid Special Characters
Tests all RFC-allowed special characters in local part:

- `!user@domain.com`, `#user@domain.com`, `$user@domain.com`
- `%user@domain.com`, `&user@domain.com`, `'user@domain.com`
- `*user@domain.com`, `=user@domain.com`, `?user@domain.com`
- `^user@domain.com`, `{user@domain.com`, `|user@domain.com`

**Security Relevance**: Tests for special character filtering bypasses and injection vulnerabilities.

### 10. Subdomain and Routing Tests
Tests various domain structures:

- `user@mail.collaborator.com` - Mail subdomain
- `user@mx.collaborator.com` - MX subdomain
- `user@collaborator.local` - Local domain
- `user@collaborator.localdomain` - Local domain variant

**Security Relevance**: Tests DNS resolution handling and subdomain takeover possibilities.

### 11. Edge Cases with Dots
Tests boundary conditions with dot placement:

- `"user."@domain.com` - Trailing dot in quoted local part
- `".user"@domain.com` - Leading dot in quoted local part
- `"user..test"@domain.com` - Consecutive dots in quoted local part

**Security Relevance**: Tests for dot-normalization bypasses and parsing edge cases.

### 12. Length Boundary Tests
Tests RFC length limits:

- 64-character local parts (maximum allowed)
- 63-character domain labels (maximum allowed)
- Long subdomain combinations

**Security Relevance**: Tests for buffer overflow vulnerabilities and length validation bypasses.

### 13. Whitespace Handling
Tests whitespace in quoted local parts:

- `"user test"@domain.com` - Space in local part
- `" user "@domain.com` - Leading/trailing spaces
- `"\tuser\t"@domain.com` - Tab characters

**Security Relevance**: Tests for whitespace normalization bypasses and injection through whitespace.

## Why These Test Vectors Matter

1. **Email Validation Bypasses**: Many applications implement incomplete email validation that can be bypassed using edge cases.

2. **Injection Attacks**: Improper email parsing can lead to header injection, SMTP injection, or other attack vectors.

3. **Authentication Bypasses**: Case sensitivity and normalization issues can allow duplicate account creation or authentication bypasses.

4. **SSRF Vulnerabilities**: IP literals in email domains can trigger server-side request forgery when systems attempt to validate emails.

5. **Encoding Attacks**: Unicode, Punycode, and encoded word handling can introduce encoding-based attack vectors.

6. **Legacy System Issues**: Old routing formats might be processed by legacy components in modern systems.

## Usage Recommendations

- **Penetration Testing**: Use these variants to test email input fields, registration forms, and password reset functionality.
- **Bug Bounty**: Focus on authentication, user registration, and email verification endpoints.
- **Security Assessment**: Test all email-processing functionality including APIs, forms, and import features.
- **Compliance Testing**: Verify RFC compliance and proper handling of edge cases.

## Important Notes

- These test vectors are designed for **authorized security testing only**
- Always ensure you have permission before testing against any system
- Some variants may trigger security alerts - use responsibly
- Consider the context of your testing (internal vs external, production vs staging)

## References

- [RFC 5322 - Internet Message Format](https://tools.ietf.org/html/rfc5322)
- [RFC 6530 - Overview and Framework for Internationalized Email](https://tools.ietf.org/html/rfc6530)
- [RFC 2047 - MIME Encoded-Word Extensions](https://tools.ietf.org/html/rfc2047)
- [PortSwigger Email Atom Splitting Research](https://portswigger.net/research/splitting-the-email-atom)
